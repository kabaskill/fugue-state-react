import{n as $,i as D,k as F,l as O,q as E,s as T,v as H,d as M,t as k,x as _,y as R,z as K,B as W,o as w,C as U,u as X,b as z,j as c}from"./index-BgkmG47c.js";var Y=t=>{const e=t.reduce((s,n)=>{const o=$(n).chroma;return o!==void 0&&(s[o]=s[o]||$(n).name),s},{});return s=>e[s]};function G(t,e={}){const s=t.map(o=>$(o).pc).filter(o=>o);return $.length===0?[]:nt(s,1,e).filter(o=>o.weight).sort((o,a)=>a.weight-o.weight).map(o=>o.name)}var C={anyThirds:384,perfectFifth:16,nonPerfectFifths:40,anySeventh:3},P=t=>e=>!!(e&t),J=P(C.anyThirds),Q=P(C.perfectFifth),V=P(C.anySeventh),Z=P(C.nonPerfectFifths);function tt(t){const e=parseInt(t.chroma,2);return J(e)&&Q(e)&&V(e)}function et(t){const e=parseInt(t,2);return Z(e)?t:(e|16).toString(2)}function nt(t,e,s){const n=t[0],o=$(n).chroma,a=Y(t),u=D(t,!1),d=[];return u.forEach((h,m)=>{const p=s.assumePerfectFifth&&et(h);F().filter(l=>s.assumePerfectFifth&&tt(l)?l.chroma===p:l.chroma===h).forEach(l=>{const g=l.aliases[0],r=a(m);m!==o?d.push({weight:.5*e,name:`${r}${g}/${n}`}):d.push({weight:1*e,name:`${r}${g}`})})}),d}var st=ot((t,e)=>[t[0]-e[0],t[1]-e[1]]);function ot(t){return(e,s)=>{const n=O(e).coord,o=O(s).coord;if(n&&o){const a=t(n,o);return E(a).name}}}var L={empty:!0,name:"",symbol:"",root:"",bass:"",rootDegree:0,type:"",tonic:null,setNum:NaN,quality:"Unknown",chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function B(t){const[e,s,n,o]=T(t);return e===""?A("",t):e==="A"&&o==="ug"?A("","aug"):A(e+s,n+o)}function A(t,e){const s=e.split("/");if(s.length===1)return[t,s[0],""];const[n,o,a,u]=T(s[1]);return n!==""&&a===""&&u===""?[t,s[0],n+o]:[t,e,""]}function x(t){if(Array.isArray(t))return S(t[1]||"",t[0],t[2]);if(t==="")return L;{const[e,s,n]=B(t),o=S(s,e,n);return o.empty?S(t):o}}function S(t,e,s){const n=H(t),o=$(e||""),a=$(s||"");if(n.empty||e&&o.empty||s&&a.empty)return L;const u=M(o.pc,a.pc),d=n.intervals.indexOf(u),h=d>=0,m=h?a:$(""),p=d===-1?NaN:d+1,y=a.pc&&a.pc!==o.pc,l=Array.from(n.intervals);if(h)for(let f=1;f<p;f++){const v=l[0][0],b=l[0][1],j=parseInt(v,10)+7;l.push(`${j}${b}`),l.shift()}else if(y){const f=st(M(o.pc,a.pc),"8P");f&&l.unshift(f)}const g=o.empty?[]:l.map(f=>k(o.pc,f));t=n.aliases.indexOf(t)!==-1?t:n.aliases[0];const r=`${o.empty?"":o.pc}${t}${h&&p>1?"/"+m.pc:y?"/"+a.pc:""}`,i=`${e?o.pc+" ":""}${n.name}${h&&p>1?" over "+m.pc:y?" over "+a.pc:""}`;return{...n,name:i,symbol:r,tonic:o.pc,type:n.name,root:m.pc,bass:y?a.pc:"",intervals:l,rootDegree:p,notes:g}}var rt=x;function at(t,e){const[s,n,o]=B(t);if(!s)return t;const a=k(o,e),u=a?"/"+a:"";return k(s,e)+n+u}function ct(t){const e=x(t),s=_(e.chroma);return R().filter(n=>s(n.chroma)).map(n=>n.name)}function it(t){const e=x(t),s=_(e.chroma);return F().filter(n=>s(n.chroma)).map(n=>e.tonic+n.aliases[0])}function lt(t){const e=x(t),s=K(e.chroma);return F().filter(n=>s(n.chroma)).map(n=>e.tonic+n.aliases[0])}function ft(t,e){const s=x(t),n=e||s.tonic;return!n||s.empty?[]:s.intervals.map(o=>k(n,o))}function ht(t,e){const s=x(t),n=e||s.tonic,o=W(s.intervals,n);return a=>a?o(a>0?a-1:a):""}function ut(t,e){const s=x(t),n=e||s.tonic;return W(s.intervals,n)}var dt={getChord:S,get:x,detect:G,chordScales:ct,extended:it,reduced:lt,tokenize:B,transpose:at,degrees:ht,steps:ut,notes:ft,chord:rt};function mt(){const s=w.value.allNotes,n=w.value.rootNote,o=U.chromatic([n+3,n+4],{sharps:!0}).slice(0,-1),{activeNotes:a,pianoOnce:u,offset:d,changeOffset:h}=X(),m=a.map(r=>z.fromMidiSharps(r)),p=400/2,y=400/2,l=r=>{const i=r/26.67,f=r/33.33,v=r/40,b=r/11,j=r/2.8,N=r/6.67,I=r/8,q=r/4;return`M 0,0 a ${i},${i},0,0,0,${f},${-v} l ${b} ${-j} a ${N},${N},0,0,0,1,${-v} a ${I},${I},0,0,0,${-q},0 a ${N},${N},0,0,0,1,${v} l ${b},${j} a ${i},${i},0,0,0,${f},${v}z`};function g(r){const i=o[r];u(i,.5)}return c.jsxs("div",{className:"flex flex-col size-full",children:[c.jsxs("svg",{viewBox:`-80 -80 ${400+2*80} ${400+2*80}`,xmlns:"http://www.w3.org/2000/svg",textAnchor:"middle",dominantBaseline:"middle",children:[c.jsx("text",{x:400/2,y:400/2,style:{fontSize:"1.2rem"},fill:"white",children:dt.detect(m)[0]}),c.jsx("g",{transform:`translate(${p}, ${y}) `,children:Object.keys(s).map((r,i)=>{const f=a.find(b=>z.pitchClass(z.fromMidiSharps(b))===r),v=+z.fromMidi(f).slice(-1);return c.jsxs("g",{onClick:()=>g(i),style:{transition:"opacity 500ms ease-out",cursor:"pointer",opacity:f?"1":"0.35"},children:[c.jsx("g",{transform:` rotate(${i*30}) translate(0, -${400/8}) `,children:c.jsx("path",{d:l(400),fill:r.length>1?"#222":"#eee"})}),c.jsxs("g",{transform:`rotate(${i*30}) translate(0, -${400/2+80/6}) `,children:[c.jsx("circle",{cx:"0",cy:"0",r:400/10,fill:s[r]}),c.jsx("text",{x:"0",y:"0",fill:"white",fontFamily:"monospace",fontSize:400/10,fontWeight:"bold",textAnchor:"middle",dominantBaseline:"middle",transform:`rotate(${i*-30})`,children:w.value.notation==="chromatic"?i:w.value.notation==="do-re-mi"?w.value.doremiObject[r]:r}),f&&c.jsx("text",{x:"0",y:"27",fill:"white",fontFamily:"monospace",fontSize:400/15,fontWeight:"bold",textAnchor:"middle",dominantBaseline:"middle",transform:`rotate(${i*-30})`,children:v}),f&&c.jsx("circle",{cx:"0",cy:80,r:400/40,fill:s[r]})]})]},`chroma-petals-${r}`)})})]}),c.jsxs("div",{className:"flex justify-around items-center w-full mb-2",children:[c.jsx("button",{onClick:r=>{r.stopPropagation(),h(-1)},className:"z-50  p-1 bg-blue-600 text-white rounded-full hover:bg-blue-400",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 hover:scale-110",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 12H5"})})}),c.jsxs("p",{className:"text-3xl text-white",children:["Transpose Octave: ",d]}),c.jsx("button",{onClick:r=>{r.stopPropagation(),h(1)},className:"z-50  p-1 bg-blue-600 text-white rounded-full hover:bg-blue-400 ",children:c.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 hover:scale-110",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:c.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})})})]})]})}const vt=Object.freeze(Object.defineProperty({__proto__:null,default:mt},Symbol.toStringTag,{value:"Module"}));export{mt as C,vt as a,dt as c};
