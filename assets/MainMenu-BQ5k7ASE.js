import{u as S,r as t,h as a,j as s,_ as x,f as j,o as p}from"./index-BQAcSKmR.js";import{C}from"./ChromaFlower-CgZa0WXF.js";const d=Object.assign({"../data/midiData/Erlkönig.json":()=>x(()=>import("./Erlkönig-BXhmgAdO.js"),[]),"../data/midiData/bach-999.json":()=>x(()=>import("./bach-999-BGsKa4lg.js"),[])});function A(){const{piano:n,addActiveNote:u,removeActiveNote:m,releaseAllNotes:v}=S(),[f,o]=t.useState(!1),[i,g]=t.useState(null),[c,b]=t.useState("Erlkönig"),[P,y]=t.useState([]);t.useEffect(()=>{const e=Object.keys(d).map(l=>l.replace("../data/midiData/","").replace(".json",""));y(e)},[]);const h=t.useCallback(e=>{const l=e.time,N=l+e.duration;a().schedule(r=>{n.triggerAttack(e.name,r,e.velocity),u(e.name)},l),a().schedule(r=>{n.triggerRelease(e.name,r),m(e.name)},N)},[n,u,m]);t.useEffect(()=>{if(c){const e=`../data/midiData/${c}.json`;d[e]&&d[e]().then(l=>{g(l.default)})}},[c]),t.useEffect(()=>{if(i&&i.tracks)return a().cancel(),a().stop(),i.tracks.forEach(e=>{e.notes.forEach(h)}),()=>{a().cancel(),a().stop()}},[i,h]);const E=()=>{a().start(),o(!0)},_=()=>{a().pause(),o(!1)},k=()=>{a().stop(),o(!1),v()};return s.jsxs("div",{className:"flex flex-col items-center justify-center gap-4",children:[s.jsx("p",{children:"Midi Player"}),s.jsxs("div",{className:"flex",children:[s.jsx("button",{onClick:E,disabled:f,children:"Play"}),s.jsx("button",{onClick:_,disabled:!f,children:"Pause"}),s.jsx("button",{onClick:k,children:"Stop"})]}),s.jsxs("label",{className:"flex w-full justify-between",children:["Select a midi file:",s.jsx("select",{value:c,onChange:e=>b(e.target.value),children:P.map(e=>s.jsx("option",{value:e,children:e},e))})]})]})}function w(){return s.jsxs("section",{className:"m-auto flex h-2/3 w-4/5 items-center justify-around gap-16",children:[s.jsx("div",{className:"aspect-square w-1/2",children:s.jsx(C,{})}),s.jsxs("div",{className:"flex h-4/5 flex-col justify-between",children:[s.jsx("h1",{className:"text-6xl",children:"Fugue State"}),s.jsxs("div",{className:"flex flex-col gap-4",children:[s.jsx("button",{onClick:()=>{j.value={...j.value,currentScene:"cutscene"}},children:"Play"}),s.jsx("button",{onClick:()=>p.value={...p.value,isActive:!0},children:"Options"}),s.jsx(A,{})]})]})]})}export{w as default};
