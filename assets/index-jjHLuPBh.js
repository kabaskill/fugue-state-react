import{n as a,i as q,k as F,l as P,q as M,s as T,v as D,d as w,t as $,x as k,y as E,z as K,A as x}from"./index-DHfW8c4l.js";var R=t=>{const n=t.reduce((s,e)=>{const o=a(e).chroma;return o!==void 0&&(s[o]=s[o]||a(e).name),s},{});return s=>n[s]};function U(t,n={}){const s=t.map(o=>a(o).pc).filter(o=>o);return a.length===0?[]:L(s,1,n).filter(o=>o.weight).sort((o,r)=>r.weight-o.weight).map(o=>o.name)}var A={anyThirds:384,perfectFifth:16,nonPerfectFifths:40,anySeventh:3},g=t=>n=>!!(n&t),W=g(A.anyThirds),_=g(A.perfectFifth),j=g(A.anySeventh),G=g(A.nonPerfectFifths);function H(t){const n=parseInt(t.chroma,2);return W(n)&&_(n)&&j(n)}function J(t){const n=parseInt(t,2);return G(n)?t:(n|16).toString(2)}function L(t,n,s){const e=t[0],o=a(e).chroma,r=R(t),f=q(t,!1),u=[];return f.forEach((h,l)=>{const p=s.assumePerfectFifth&&J(h);F().filter(c=>s.assumePerfectFifth&&H(c)?c.chroma===p:c.chroma===h).forEach(c=>{const v=c.aliases[0],y=r(l);l!==o?u.push({weight:.5*n,name:`${y}${v}/${e}`}):u.push({weight:1*n,name:`${y}${v}`})})}),u}var Q=V((t,n)=>[t[0]-n[0],t[1]-n[1]]);function V(t){return(n,s)=>{const e=P(n).coord,o=P(s).coord;if(e&&o){const r=t(e,o);return M(r).name}}}var z={empty:!0,name:"",symbol:"",root:"",bass:"",rootDegree:0,type:"",tonic:null,setNum:NaN,quality:"Unknown",chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function I(t){const[n,s,e,o]=T(t);return n===""?S("",t):n==="A"&&o==="ug"?S("","aug"):S(n+s,e+o)}function S(t,n){const s=n.split("/");if(s.length===1)return[t,s[0],""];const[e,o,r,f]=T(s[1]);return e!==""&&r===""&&f===""?[t,s[0],e+o]:[t,n,""]}function i(t){if(Array.isArray(t))return b(t[1]||"",t[0],t[2]);if(t==="")return z;{const[n,s,e]=I(t),o=b(s,n,e);return o.empty?b(t):o}}function b(t,n,s){const e=D(t),o=a(n||""),r=a(s||"");if(e.empty||n&&o.empty||s&&r.empty)return z;const f=w(o.pc,r.pc),u=e.intervals.indexOf(f),h=u>=0,l=h?r:a(""),p=u===-1?NaN:u+1,d=r.pc&&r.pc!==o.pc,c=Array.from(e.intervals);if(h)for(let m=1;m<p;m++){const C=c[0][0],B=c[0][1],O=parseInt(C,10)+7;c.push(`${O}${B}`),c.shift()}else if(d){const m=Q(w(o.pc,r.pc),"8P");m&&c.unshift(m)}const v=o.empty?[]:c.map(m=>$(o.pc,m));t=e.aliases.indexOf(t)!==-1?t:e.aliases[0];const y=`${o.empty?"":o.pc}${t}${h&&p>1?"/"+l.pc:d?"/"+r.pc:""}`,N=`${n?o.pc+" ":""}${e.name}${h&&p>1?" over "+l.pc:d?" over "+r.pc:""}`;return{...e,name:N,symbol:y,tonic:o.pc,type:e.name,root:l.pc,bass:d?r.pc:"",intervals:c,rootDegree:p,notes:v}}var X=i;function Y(t,n){const[s,e,o]=I(t);if(!s)return t;const r=$(o,n),f=r?"/"+r:"";return $(s,n)+e+f}function Z(t){const n=i(t),s=k(n.chroma);return E().filter(e=>s(e.chroma)).map(e=>e.name)}function tt(t){const n=i(t),s=k(n.chroma);return F().filter(e=>s(e.chroma)).map(e=>n.tonic+e.aliases[0])}function nt(t){const n=i(t),s=K(n.chroma);return F().filter(e=>s(e.chroma)).map(e=>n.tonic+e.aliases[0])}function et(t,n){const s=i(t),e=n||s.tonic;return!e||s.empty?[]:s.intervals.map(o=>$(e,o))}function st(t,n){const s=i(t),e=n||s.tonic,o=x(s.intervals,e);return r=>r?o(r>0?r-1:r):""}function ot(t,n){const s=i(t),e=n||s.tonic;return x(s.intervals,e)}var ct={getChord:b,get:i,detect:U,chordScales:Z,extended:tt,reduced:nt,tokenize:I,transpose:Y,degrees:st,steps:ot,notes:et,chord:X};export{ct as c};
